<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Event Registration</title>
    <!-- Razorpay script with fallback and retry mechanism -->
    <script>
      (function() {
        let retryCount = 0;
        const maxRetries = 3;
        const retryDelay = 2000;
        
        function loadRazorpay() {
          return new Promise((resolve, reject) => {
            const script = document.createElement('script');
            script.src = 'https://checkout.razorpay.com/v1/checkout.js';
            script.async = true;
            
            script.onload = () => {
              console.log('‚úÖ Razorpay script loaded successfully');
              // Suppress non-critical Razorpay resource errors
              window.razorpayLoaded = true;
              resolve();
            };
            
            script.onerror = () => {
              console.error('‚ùå Failed to load Razorpay script');
              reject(new Error('Razorpay script failed to load'));
            };
            
            document.head.appendChild(script);
            
            // Timeout fallback
            setTimeout(() => {
              if (typeof window.Razorpay === 'undefined') {
                reject(new Error('Razorpay script load timeout'));
              }
            }, 10000);
          });
        }
        
        async function retryLoadRazorpay() {
          try {
            await loadRazorpay();
            console.log('üéâ Razorpay successfully initialized');
          } catch (error) {
            retryCount++;
            console.error(`‚ùå Razorpay load attempt ${retryCount} failed:`, error.message);
            
            if (retryCount < maxRetries) {
              console.log(`üîÑ Retrying Razorpay load in ${retryDelay}ms...`);
              setTimeout(retryLoadRazorpay, retryDelay);
            } else {
              console.error('üí• Failed to load Razorpay after all retries');
              window.razorpayLoadFailed = true;
            }
          }
        }
        
        // Start loading Razorpay when DOM is ready
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', retryLoadRazorpay);
        } else {
          retryLoadRazorpay();
        }
        
        // Suppress non-critical Razorpay resource errors (including chunk loading errors)
        window.addEventListener('error', function(event) {
          // Check if this is a non-critical Razorpay resource error
          if (event.target && (event.target.src || event.target.href)) {
            const resourceUrl = event.target.src || event.target.href;
            if (resourceUrl.includes('razorpay.com') && !resourceUrl.includes('checkout.js')) {
              console.warn('‚ö†Ô∏è Non-critical Razorpay resource failed to load:', resourceUrl);
              event.preventDefault();
              return false;
            }
          }
        }, true);
        
        // Suppress Razorpay chunk loading errors (these are internal Razorpay errors)
        window.addEventListener('unhandledrejection', function(event) {
          if (event.reason && event.reason.message) {
            const msg = event.reason.message.toLowerCase();
            if (msg.includes('loading chunk') || 
                msg.includes('chunkloaderror') || 
                msg.includes('loading css chunk') ||
                (msg.includes('razorpay') && msg.includes('failed'))) {
              console.warn('‚ö†Ô∏è Razorpay chunk loading error (CDN issue):', event.reason.message);
              console.info('üí° This is usually caused by network/firewall issues or ad blockers.');
              event.preventDefault();
              window.razorpayChunkError = true;
              return false;
            }
          }
        });
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
